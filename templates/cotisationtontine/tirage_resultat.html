{% extends 'base.html' %}
{% load humanize %}

{% block title %}ğŸ² Tirage au sort{% endblock %}

{% block content %}
<div class="container mt-5 text-center" style="max-width: 600px;">

    <h1 class="mb-4 text-primary fw-bold">ğŸ² Tirage au sort</h1>

    <h4 class="mb-3">
        Groupe :
        <span class="text-success fw-semibold">
            {{ group.nom }}
        </span>
    </h4>

    {% if erreur %}
        <div class="alert alert-danger" role="alert">
            âš ï¸ {{ erreur }}
        </div>
    {% endif %}

    {% if tirage_possible %}
        <a href="{% url 'cotisationtontine:tirage_au_sort' group.id %}"
           class="btn btn-primary btn-lg mb-3">
           ğŸ² Lancer le tirage au sort
        </a>
    {% else %}
        <a href="#"
           class="btn btn-secondary btn-lg disabled mb-3"
           tabindex="-1"
           aria-disabled="true">
           ğŸ² Tirage dÃ©jÃ  effectuÃ©
        </a>
    {% endif %}

    {% if gagnant %}
        <div class="mt-5 p-4 border rounded shadow-sm bg-light">

            <h2 class="text-success">ğŸ‘ FÃ©licitations ğŸ‰</h2>

            <h1 class="display-5 fw-bold text-dark mt-3">
                ğŸ†
                {{ gagnant.alias|default:gagnant.user.nom|default:gagnant.user.phone }}
            </h1>

            {% if cycle_actuel %}
                <p class="text-muted">
                    Cycle : {{ cycle_actuel }}
                </p>
            {% endif %}

            <p class="fs-4 mt-3">
                Montant remportÃ© :
                <strong class="text-danger">
                    {{ montant_total|floatformat:0|intcomma }} FCFA
                </strong>
            </p>

            <div class="mt-4">
                <a href="{% url 'cotisationtontine:group_detail' group.id %}"
                   class="btn btn-success btn-lg px-4">
                   ğŸ“Š Voir le dÃ©tail du groupe
                </a>
            </div>

        </div>
    {% else %}
        <div class="alert alert-warning mt-5" role="alert">
            Aucun membre Ã©ligible au tirage pour le moment.
        </div>
    {% endif %}

    <a href="{% url 'cotisationtontine:dashboard_tontine_simple' %}"
       class="btn btn-outline-primary mt-4 px-4">
        â¬… Retour au tableau de bord
    </a>

</div>
{% endblock %}
