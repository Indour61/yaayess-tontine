{% extends "base.html" %}
{% block content %}
  <div class="container mt-4">
    <h2>Rejoindre le groupe : {{ group.nom|default:"—" }}</h2>

    {% if forced_option == "1" %}
      <div class="alert alert-success">
        ✅ Option sélectionnée automatiquement : <strong>Cotisation & Tontine</strong>
      </div>
    {% elif forced_option == "2" %}
      <div class="alert alert-info">
        ✅ Option sélectionnée automatiquement : <strong>Épargne & Crédit</strong>
      </div>
    {% endif %}

    {% for message in messages %}
      <div class="alert alert-{{ message.tags|default:'info' }}">{{ message|safe }}</div>
    {% endfor %}

    <form method="post" novalidate>
      {% csrf_token %}

      <div class="mb-3">
        <label for="id_nom" class="form-label">Nom</label>
        <input id="id_nom" name="nom" class="form-control" required>
      </div>

      <div class="mb-3">
        <label for="id_phone" class="form-label">Téléphone</label>
        <input id="id_phone" type="tel" name="phone" class="form-control" required>
      </div>

      <div class="mb-3">
        <label for="id_password" class="form-label">Mot de passe</label>
        <input id="id_password" type="password" name="password" class="form-control" required>
      </div>

      <div class="mb-3">
        <label for="id_confirm_password" class="form-label">Confirmer mot de passe</label>
        <input id="id_confirm_password" type="password" name="confirm_password" class="form-control" required>
      </div>

      {# Si une option est imposée par le lien, on la passe en champ caché #}
      {% if forced_option %}
        <input type="hidden" name="option" value="{{ forced_option }}">
      {% else %}
        <div class="mb-3">
          <label for="id_option" class="form-label">Option</label>
          <select id="id_option" name="option" class="form-select" required>
            <option value="">— Choisir —</option>
            <option value="1">Cotisation & Tontine</option>
            <option value="2">Épargne & Crédit</option>
          </select>
        </div>
      {% endif %}

      <button class="btn btn-success">Rejoindre</button>
    </form>
  </div>
{% endblock %}
