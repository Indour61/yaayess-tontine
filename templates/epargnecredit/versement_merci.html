{% extends 'base.html' %}
{% block title %}Merci pour votre paiement{% endblock %}

{% block content %}
<div class="container mt-5" style="max-width: 560px;">

  {% if status == "paid" %}
    <div class="text-center mb-4">
      <h1 class="display-6 text-success">âœ… Merci !</h1>
      <p class="lead mb-1">Votre paiement a Ã©tÃ© confirmÃ©.</p>
      {% if created_fallback %}
        <p class="small text-muted">Lâ€™Ã©criture a Ã©tÃ© crÃ©Ã©e localement (fallback dev).</p>
      {% endif %}
      {% if token %}
        <p class="small text-muted mb-0">RÃ©fÃ©rence : <code>{{ token }}</code></p>
      {% endif %}
    </div>
  {% elif status == "pending" %}
    <div class="text-center mb-4">
      <h1 class="display-6 text-warning">â³ Paiement en attente</h1>
      <p class="mb-2">La facture a Ã©tÃ© crÃ©Ã©e mais le paiement nâ€™est pas encore confirmÃ©.</p>
      {% if invoice_url %}
        <a href="{{ invoice_url }}" class="btn btn-primary w-100 mb-2">ğŸ’³ Ouvrir la facture</a>
      {% endif %}
      {% if token %}
        <a href="?token={{ token }}{% if request.GET.group_id %}&group_id={{ request.GET.group_id }}{% endif %}"
           class="btn btn-outline-secondary w-100">ğŸ”„ RafraÃ®chir le statut</a>
      {% endif %}
    </div>
  {% elif status == "failed" %}
    <div class="text-center mb-4">
      <h1 class="display-6 text-danger">âŒ Paiement annulÃ© / Ã©chouÃ©</h1>
      <p class="mb-2">Le paiement nâ€™a pas Ã©tÃ© confirmÃ©.</p>
      {% if invoice_url %}
        <a href="{{ invoice_url }}" class="btn btn-primary w-100">RÃ©essayer le paiement</a>
      {% endif %}
    </div>
  {% elif status == "error" %}
    <div class="text-center mb-4">
      <h1 class="display-6 text-danger">âš ï¸ Erreur</h1>
      <p>Impossible de vÃ©rifier le statut pour le moment.</p>
    </div>
  {% else %}
    <div class="text-center mb-4">
      <h1 class="display-6">â„¹ï¸ Retour de paiement</h1>
      <p>Statut indÃ©terminÃ© pour cette facture.</p>
      {% if invoice_url %}
        <a href="{{ invoice_url }}" class="btn btn-primary w-100">Ouvrir la facture</a>
      {% endif %}
    </div>
  {% endif %}

  <a href="{{ back_url|default:'/' }}" class="btn btn-success w-100">â†©ï¸ Revenir</a>
</div>
{% endblock %}
